function LUI(ui){function updateCtlrs(a){var b,c;for(b=0;b<a.length;b++)if(c=a[b],c instanceof UButton)updateButton(c);else if(c instanceof UCheck)c.update();else if(c instanceof IRect)updateRegion(c);else if(c instanceof IScrollbar)updateBar(c);else if(c instanceof IViewport){if(c.updateMove())return;updateView(c)}else c.data instanceof DUIText?updateText(c):c instanceof LCtrl?c.updateNowCtrl():c instanceof LCtrlGroup?c.update():c.data instanceof DUIPic?c.visible=c.data.showIf.result():c instanceof UAutoPic&&(c.visible=c.data.showIf.result(),c.update())}function updateText(ctrl){if(ctrl.visible=ctrl.data.showIf.result(),ctrl.data.isAutoUpdate){var dText="";dText=2==ctrl.data.textType?ctrl.data.fontColor.TColor()+"\\s["+ctrl.data.fontSize+"]"+eval(ctrl.data.text):ctrl.data.fontColor.TColor()+"\\s["+ctrl.data.fontSize+"]"+ctrl.data.getDrawText(),dText!=ctrl.tag&&LUI.setText(ctrl,dText)}}function updateView(a){a.visible=a.data.showIf.result(),updateCtlrs(a.ctrls)}function updateBar(ctrl){var min,max;ctrl.visible=ctrl.data.showIf.result(),min=0,max=0,0==ctrl.data.userValue?(min=parseInt(RV.GameData.getValue(ctrl.data.minValue,0)),max=parseInt(RV.GameData.getValue(ctrl.data.maxValue,0))):1==ctrl.data.userValue&&(min=parseInt(eval(ctrl.data.min)),max=parseInt(eval(ctrl.data.max)),0>=max&&(max=1)),ctrl.setValue(min,max),ctrl.update()}function updateRegion(ctrl){ctrl.tempRect.left=IInput.x,ctrl.tempRect.top=IInput.y,ctrl.tempRect.right=IInput.x+1,ctrl.tempRect.bottom=IInput.y+1;var isIn=ctrl.intersects(ctrl.tempRect);isIn&&ctrl!=newCtrl?(newCtrl=ctrl,0==ctrl.data.hoverEvent.eventType?interpreterMain.isEnd&&interpreterMain.addEvents(ctrl.data.hoverEvent.eventEvents):1==ctrl.data.hoverEvent.eventType&&eval(ctrl.data.hoverEvent.eventScript)):isIn||ctrl!=newCtrl||(newCtrl=null,0==ctrl.data.leaveEvent.eventType?interpreterMain.isEnd&&interpreterMain.addEvents(ctrl.data.leaveEvent.eventEvents):1==ctrl.data.leaveEvent.eventType&&eval(ctrl.data.leaveEvent.eventScript)),isIn&&IInput.down&&(ctrl.long<ctrl.data.longTime&&(ctrl.long+=1,ctrl.long==ctrl.data.longTime&&(0==ctrl.data.longEvent.eventType?interpreterMain.isEnd&&interpreterMain.addEvents(ctrl.data.longEvent.eventEvents):1==ctrl.data.longEvent.eventType&&eval(ctrl.data.longEvent.eventScript),ctrl.long+=1)),0==ctrl.data.downEvent.eventType?interpreterMain.isEnd&&interpreterMain.addEvents(ctrl.data.downEvent.eventEvents):1==ctrl.data.downEvent.eventType&&eval(ctrl.data.downEvent.eventScript)),isIn&&IInput.up&&(0==ctrl.data.clickEvent.eventType?interpreterMain.isEnd&&interpreterMain.addEvents(ctrl.data.clickEvent.eventEvents):1==ctrl.data.clickEvent.eventType&&eval(ctrl.data.clickEvent.eventScript)),IInput.up&&(ctrl.long=0)}function updateButton(ctrl){var dText,size,x,y;ctrl.visible=ctrl.data.showIf.result(),ctrl.setEnable(ctrl.data.enableIF.result()),ctrl.data.text.isAutoUpdate&&(dText="",dText=2==ctrl.data.text.textType?ctrl.data.text.fontColor.TColor()+"\\s["+ctrl.data.text.fontSize+"]"+eval(ctrl.data.text.text):ctrl.data.text.fontColor.TColor()+"\\s["+ctrl.data.text.fontSize+"]"+ctrl.data.text.getDrawText(),dText!=ctrl.getText().tag&&(size=DUI.DrawTextSize(dText,!1,0),x=DUI.HPoint(ctrl.data.text.x,ctrl.data.text.HAlign,ctrl.getBack().width,size.width),y=DUI.VPoint(ctrl.data.text.y,ctrl.data.text.VAlign,ctrl.getBack().height,size.height),ctrl.getText().clearBitmap(),ctrl.getText().drawText(dText,x,y,ctrl.data.text.textStyle,ctrl.data.text.textStyleColor.IColor(),!1,0),ctrl.getText().tag=dText)),ctrl.update()&&(0==ctrl.data.clickEvent.eventType?interpreterMain.isEnd&&interpreterMain.addEvents(ctrl.data.clickEvent.eventEvents):1==ctrl.data.clickEvent.eventType&&eval(ctrl.data.clickEvent.eventScript)),1==ctrl.getBack().isSelectTouch()?ctrl!=newCtrl&&(newCtrl=ctrl,0==ctrl.data.hoverEvent.eventType?interpreterMain.isEnd&&interpreterMain.addEvents(ctrl.data.hoverEvent.eventEvents):1==ctrl.data.hoverEvent.eventType&&eval(ctrl.data.hoverEvent.eventScript)):newCtrl==ctrl&&(newCtrl=null,0==ctrl.data.leaveEvent.eventType?interpreterMain.isEnd&&interpreterMain.addEvents(ctrl.data.leaveEvent.eventEvents):1==ctrl.data.leaveEvent.eventType&&eval(ctrl.data.leaveEvent.eventScript)),1==ctrl.getBack().isSelectTouch()&&IInput.down&&(0==ctrl.data.downEvent.eventType?interpreterMain.isEnd&&interpreterMain.addEvents(ctrl.data.downEvent.eventEvents):1==ctrl.data.downEvent.eventType&&eval(ctrl.data.downEvent.eventScript))}var _sf,setp,childMain,childOther,newCtrl,interpreterMain,interpreterOther,args;this.endDo=null,this.data=ui,this.ctrlItems=[],this.ctrlKeys=[],_sf=this,setp=0,childMain=null,childOther=[],newCtrl=null,interpreterMain=new IMain,interpreterMain.ui=this,interpreterOther=new IMain,interpreterOther.ui=this,""!=this.data.scrpit&&(args="",arguments.length>1&&(args=arguments[1]),this.base=eval(this.data.scrpit),args.length>0?eval("this.base(ui ,"+args+");"):eval("this.base(ui);"),delete this.base),this.getSelfUI=function(a){if(null!=childMain)return childMain;for(var b=0;b<childOther.length;b++)if(childOther[b].data.id==a)return childOther[b];return null},this.showChildfUI=function(a,b){if(null!=a){if(a.isParallel&&null==_sf.getSelfUI(a.id)){var c=new LUI(a,b);return c.endDo=function(){for(var a=0;a<childOther.length;a++)if(childOther[a]==c){childOther.remove(c);break}},childOther.push(c),c}if(!a.isParallel)return childMain=new LUI(a,b),childMain.endDo=function(){childMain=null},childMain}},this.initCtrlPoint=function(a){var b=LUI.getCtrlRect(a.data,_sf.ctrlItems,0,0),c=a.GetRect();a.x=a.data.HPointUI(c.width,b),a.y=a.data.VPointUI(c.height,b)},this.updateAllPoint=function(a){for(var b=0;b<a.length;b++)""==a[b].data.reference&&""==a[b].data.viewportKey&&_sf.initCtrlPoint(a[b]);for(b=0;b<a.length;b++)""!=a[b].data.reference&&""==a[b].data.viewportKey&&_sf.initCtrlPoint(a[b]);for(b=0;b<a.length;b++)""==a[b].data.reference&&""!=a[b].data.viewportKey&&_sf.initCtrlPoint(a[b]);for(b=0;b<a.length;b++)""!=a[b].data.reference&&""!=a[b].data.viewportKey&&_sf.initCtrlPoint(a[b])},this.initSelfUIRes=function(){var a=_sf.data.getFiles();DUI.CacheUIRes(a,this.initSelfUI)},this.initSelfUI=function(){var i,ctrl,tempViews=[];for(i=0;i<_sf.data.ctrls.length;i++)ctrl=DUI.LoadCtrls(_sf.data.level,_sf.data.ctrls[i],null,_sf,null),null!=ctrl&&(ctrl instanceof IViewport?tempViews.push(ctrl):_sf.ctrlItems.push(ctrl),ctrl instanceof IScrollbar&&updateBar(ctrl),_sf.ctrlKeys[_sf.data.ctrls[i].key]=ctrl);for(_sf.ctrlItems=tempViews.concat(_sf.ctrlItems),_sf.updateAllPoint(_sf.ctrlItems),i=0;i<tempViews.length;i++)_sf.updateAllPoint(tempViews[i].ctrls);0==_sf.data.initAfterEvent.eventType?(interpreterMain.addEvents(_sf.data.initAfterEvent.eventEvents),setp=2):1==_sf.data.initAfterEvent.eventType&&(eval(_sf.data.initAfterEvent.eventScript),setp=3)},this.updateUI=function(){if(0==setp&&0==_sf.data.initEvent.eventType)return interpreterMain.update(),interpreterMain.isEnd&&(setp=1,this.initSelfUIRes()),!0;if(2==setp&&0==_sf.data.initAfterEvent.eventType)return interpreterMain.update(),interpreterMain.isEnd&&(setp=3),!0;if(4==setp){for(var i=0;i<childOther.length;i++)childOther[i].updateUI();return 0==_sf.data.closeEvent.eventType&&interpreterMain.update(),childOther.length<=0&&interpreterMain.isEnd&&this.disposeUI(),!0}if(3==setp){if(null!=childMain&&childMain.updateUI())return!0;for(i=0;i<childOther.length;i++)childOther[i].updateUI();if(_sf.data.isEsc&&IInput.isKeyDown(27))return _sf.closeUI(),!0;if(_sf.data.isMouse&&IInput.down&&1==IInput.MenuButton)return _sf.closeUI(),!0;interpreterMain.update(),0==_sf.data.updateEvent.eventType?(interpreterOther.isEnd&&interpreterOther.addEvents(_sf.data.updateEvent.eventEvents),interpreterOther.update()):1==_sf.data.updateEvent.eventType&&eval(_sf.data.updateEvent.eventScript),updateCtlrs(_sf.ctrlItems)}return!0},this.disposeUI=function(){setp=5,null!=this.endDo&&this.endDo()},this.closeUI=function(){setp=4;for(var i=0;i<childOther.length;i++)childOther[i].closeUI();0==_sf.data.closeEvent.eventType?interpreterMain.addEvents(_sf.data.closeEvent.eventEvents):1==_sf.data.closeEvent.eventType&&eval(_sf.data.closeEvent.eventScript)},this.disposeAll=function(){null!=childMain&&childMain.disposeAll();for(var a=0;a<childOther.length;a++)childOther[a].disposeAll();childMain=null,childOther.length=0,LUI.DisposeCtrl(this.ctrlItems),this.ctrlKeys={}},this.getInterpreterMain=function(){return interpreterMain},0==this.data.initEvent.eventType?interpreterMain.addEvents(this.data.initEvent.eventEvents):1==this.data.initEvent.eventType&&(eval(this.data.initEvent.eventScript),this.initSelfUIRes())}function LCtrl(data,view,ui,obj,rdata){function initCtrlPoint(a){var b=LUI.getCtrlRect(a.data,_sf.ctrlItems,x,y),c=a.data.HPointUI(a.width,b),d=a.data.VPointUI(a.height,b);a.x=x+c,a.y=y+d,c+a.width>_sf.width&&(_sf.width=c+a.width),d+a.height>_sf.height&&(_sf.height=d+a.height)}function updateCtlrs(a){var b,c;for(b=0;b<a.length;b++)if(c=a[b],c instanceof UButton)updateButton(c);else if(c instanceof UCheck)c.update();else if(c instanceof IRect)updateRegion(c);else if(c instanceof IScrollbar)updateBar(c);else if(c instanceof IViewport){if(c.updateMove())return;updateView(c)}else c.data instanceof DUIText?updateText(c):c.data instanceof DUIPic?visible&&(c.visible=c.data.showIf.result()):c instanceof UAutoPic&&(visible&&(c.visible=c.data.showIf.result()),c.update())}function updateText(ctrl){if(visible&&(ctrl.visible=ctrl.data.showIf.result()),ctrl.data.isAutoUpdate){var dText="";dText=2==ctrl.data.textType?ctrl.data.fontColor.TColor()+"\\s["+ctrl.data.fontSize+"]"+eval(ctrl.data.text):ctrl.data.fontColor.TColor()+"\\s["+ctrl.data.fontSize+"]"+ctrl.data.getDrawText(),dText!=ctrl.tag&&LUI.setText(ctrl,dText)}}function updateView(a){visible&&(a.visible=a.data.showIf.result()),updateCtlrs(a.ctrls)}function updateBar(ctrl){var min,max;visible&&(ctrl.visible=ctrl.data.showIf.result()),min=0,max=0,0==ctrl.data.userValue?(min=parseInt(RV.GameData.getValue(ctrl.data.minValue,0)),max=parseInt(RV.GameData.getValue(ctrl.data.maxValue,1))):1==ctrl.data.userValue&&(min=parseInt(eval(ctrl.data.min)),max=parseInt(eval(ctrl.data.max)),0>=max&&(max=1)),ctrl.setValue(min,max),ctrl.update()}function updateRegion(ctrl){ctrl.tempRect.left=IInput.x,ctrl.tempRect.top=IInput.y,ctrl.tempRect.right=IInput.x+1,ctrl.tempRect.bottom=IInput.y+1;var isIn=ctrl.intersects(ctrl.tempRect);isIn&&ctrl!=newCtrl?(newCtrl=ctrl,0==ctrl.data.hoverEvent.eventType?interpreterMain.isEnd&&interpreterMain.addEvents(ctrl.data.hoverEvent.eventEvents):1==ctrl.data.hoverEvent.eventType&&eval(ctrl.data.hoverEvent.eventScript)):isIn||newCtrl!=ctrl||(newCtrl=null,0==ctrl.data.leaveEvent.eventType?interpreterMain.isEnd&&interpreterMain.addEvents(ctrl.data.leaveEvent.eventEvents):1==ctrl.data.leaveEvent.eventType&&eval(ctrl.data.leaveEvent.eventScript)),isIn&&IInput.down&&(ctrl.long<ctrl.data.longTime&&(ctrl.long+=1,ctrl.long==ctrl.data.longTime&&(0==ctrl.data.longEvent.eventType?interpreterMain.isEnd&&interpreterMain.addEvents(ctrl.data.longEvent.eventEvents):1==ctrl.data.longEvent.eventType&&eval(ctrl.data.longEvent.eventScript),ctrl.long+=1)),0==ctrl.data.downEvent.eventType?interpreterMain.isEnd&&interpreterMain.addEvents(ctrl.data.downEvent.eventEvents):1==ctrl.data.downEvent.eventType&&eval(ctrl.data.downEvent.eventScript)),isIn&&IInput.up&&(0==ctrl.data.clickEvent.eventType?interpreterMain.isEnd&&interpreterMain.addEvents(ctrl.data.clickEvent.eventEvents):1==ctrl.data.clickEvent.eventType&&eval(ctrl.data.clickEvent.eventScript)),IInput.up&&(ctrl.long=0)}function updateButton(ctrl){var dText,size,x,y;visible&&(ctrl.visible=ctrl.data.showIf.result()),ctrl.setEnable(ctrl.data.enableIF.result()),ctrl.data.text.isAutoUpdate&&(dText="",dText=2==ctrl.data.text.textType?ctrl.data.text.fontColor.TColor()+"\\s["+ctrl.data.text.fontSize+"]"+eval(ctrl.data.text.text):ctrl.data.text.fontColor.TColor()+"\\s["+ctrl.data.text.fontSize+"]"+ctrl.data.text.getDrawText(),dText!=ctrl.getText().tag&&(size=DUI.DrawTextSize(dText,!1,0),x=DUI.HPoint(ctrl.data.text.x,ctrl.data.text.HAlign,ctrl.getBack().width,size.width),y=DUI.VPoint(ctrl.data.text.y,ctrl.data.text.VAlign,ctrl.getBack().height,size.height),ctrl.getText().clearBitmap(),ctrl.getText().drawText(dText,x,y,ctrl.data.text.textStyle,ctrl.data.text.textStyleColor.IColor(),!1,0),ctrl.getText().tag=dText)),ctrl.update()&&(0==ctrl.data.clickEvent.eventType?interpreterMain.isEnd&&interpreterMain.addEvents(ctrl.data.clickEvent.eventEvents):1==ctrl.data.clickEvent.eventType&&eval(ctrl.data.clickEvent.eventScript)),1==ctrl.getBack().isSelectTouch()?ctrl!=newCtrl&&(newCtrl=ctrl,0==ctrl.data.hoverEvent.eventType?interpreterMain.isEnd&&interpreterMain.addEvents(ctrl.data.hoverEvent.eventEvents):1==ctrl.data.hoverEvent.eventType&&eval(ctrl.data.hoverEvent.eventScript)):newCtrl==ctrl&&(newCtrl=null,0==ctrl.data.leaveEvent.eventType?interpreterMain.isEnd&&interpreterMain.addEvents(ctrl.data.leaveEvent.eventEvents):1==ctrl.data.leaveEvent.eventType&&eval(ctrl.data.leaveEvent.eventScript)),1==ctrl.getBack().isSelectTouch()&&IInput.down&&(0==ctrl.data.downEvent.eventType?interpreterMain.isEnd&&interpreterMain.addEvents(ctrl.data.downEvent.eventEvents):1==ctrl.data.downEvent.eventType&&eval(ctrl.data.downEvent.eventScript))}function updateSlide(){0>=slideFrames||(slideFrames-=1,0>=slideFrames?(_sf.x=endX,_sf.y=endY):(tmpX+=diffX,tmpY+=diffY,_sf.x=tmpX,_sf.y=tmpY))}var x,y,visible,rect,_sf,setp,newCtrl,interpreterMain,interpreterOther,args,slideFrames,endX,endY,diffX,diffY,tmpX,tmpY;this.ui=ui,this.cof=data,this.data=rdata,this.obj=obj,this.ctrlItems=[],this.ctrlKeys=[],x=0,y=0,visible=!0,this.width=0,this.height=0,rect=new IRect(0,0,1,1),_sf=this,setp=0,newCtrl=null,interpreterMain=new IMain,interpreterMain.ui=ui,interpreterMain.ctrl=_sf,interpreterOther=new IMain,interpreterOther.ui=ui,interpreterOther.ctrl=_sf,""!=this.cof.script&&(args="",arguments.length>1&&(args=arguments[1]),this.base=eval(this.cof.script),eval("this.base(ui , _sf , obj);"),delete this.base),this.initSelfUIRes=function(){var a=_sf.cof.getFiles();DUI.CacheUIRes(a,this.initSelfUI)},this.initSelfUI=function(){var i,ctrl,tempViews=[],z=ui.data.level;for(null!=view&&(z=0),null!=_sf.data&&(visible=_sf.data.showIf.result()),i=0;i<_sf.cof.ctrls.length;i++)ctrl=DUI.LoadCtrls(z,_sf.cof.ctrls[i],view,_sf,obj),null!=ctrl&&(ctrl instanceof IViewport?tempViews.push(ctrl):_sf.ctrlItems.push(ctrl),ctrl instanceof IScrollbar&&updateBar(ctrl),visible||(ctrl.visible=!1),_sf.ctrlKeys[_sf.cof.ctrls[i].key]=ctrl);for(_sf.ctrlItems=tempViews.concat(_sf.ctrlItems),_sf.updateAllPoint(_sf.ctrlItems),i=0;i<tempViews.length;i++)_sf.updateAllPoint(tempViews[i].ctrls);0==_sf.cof.initAfterEvent.eventType?(interpreterMain.addEvents(_sf.cof.initAfterEvent.eventEvents),setp=2):1==_sf.cof.initAfterEvent.eventType&&(eval(_sf.cof.initAfterEvent.eventScript),setp=3)},this.updateAllPoint=function(a){for(var b=0;b<a.length;b++)""==a[b].data.reference&&""==a[b].data.viewportKey&&initCtrlPoint(a[b]);for(b=0;b<a.length;b++)""!=a[b].data.reference&&""==a[b].data.viewportKey&&initCtrlPoint(a[b]);for(b=0;b<a.length;b++)""==a[b].data.reference&&""!=a[b].data.viewportKey&&initCtrlPoint(a[b]);for(b=0;b<a.length;b++)""!=a[b].data.reference&&""!=a[b].data.viewportKey&&initCtrlPoint(a[b])},this.updateUBaseRelativePoint=function(a){for(var b=0;b<_sf.ctrlItems.length;b++)_sf.ctrlItems[b].data.reference==a&&initCtrlPoint(_sf.ctrlItems[b])},this.updateNowCtrl=function(){if(null!=_sf.data&&(_sf.visible=_sf.data.showIf.result()),0==setp&&0==_sf.cof.initEvent.eventType)return interpreterMain.update(),interpreterMain.isEnd&&(setp=1,this.initSelfUIRes()),!0;if(2==setp&&0==_sf.cof.initAfterEvent.eventType)return interpreterMain.update(),interpreterMain.isEnd&&(setp=3),!0;if(3==setp){if(updateSlide(),!_sf.visible)return;interpreterMain.update(),0==_sf.cof.updateEvent.eventType?(interpreterOther.isEnd&&interpreterOther.addEvents(_sf.cof.updateEvent.eventEvents),interpreterOther.update()):1==_sf.cof.updateEvent.eventType&&eval(_sf.cof.updateEvent.eventScript),updateCtlrs(_sf.ctrlItems)}return!0},this.disposeNowCtrl=function(){LUI.DisposeCtrl(_sf.ctrlItems)},this.getInterpreterMain=function(){return interpreterMain},this.GetRect=function(){return rect.left=x,rect.top=y,rect.right=x+_sf.width,rect.bottom=y+_sf.height,rect},Object.defineProperty(this,"x",{get:function(){return x},set:function(a){x=a,_sf.updateAllPoint(_sf.ctrlItems)}}),Object.defineProperty(this,"y",{get:function(){return y},set:function(a){y=a,_sf.updateAllPoint(_sf.ctrlItems)}}),Object.defineProperty(this,"visible",{get:function(){return visible},set:function(a){if(a!=visible){visible=a;for(var b=0;b<_sf.ctrlItems.length;b++)_sf.ctrlItems[b].visible=visible}}}),0==this.cof.initEvent.eventType?interpreterMain.addEvents(this.cof.initEvent.eventEvents):1==this.cof.initEvent.eventType&&(eval(this.cof.initEvent.eventScript),this.initSelfUIRes()),slideFrames=0,endX=0,endY=0,diffX=0,diffY=0,tmpX=0,tmpY=0,this.slideTo=function(a,b,c){this.slide(_sf.x,_sf.y,a,b,c)},this.slide=function(a,b,c,d,e){0>=e?(_sf.x=c,_sf.y=d):(slideFrames=e,endX=c,endY=d,diffX=(endX-a)/parseFloat(e),diffY=(endY-b)/parseFloat(e),tmpX=a,tmpY=b,_sf.x=a,_sf.y=b)}}function DUI(a){var d,b=a,c=new IRWFile("UI.ifui");this.code=0,this.key="",this.uis={},this.ctrls={},d=this,c.onload=function(){var a,e,f,g;for(d.code=c.readInt(),d.key=c.readString(),a=c.readInt(),d.uis=[],e=0;a>e;e++)f=new DUIMain(c),d.uis[f.id]=f;for(a=c.readInt(),d.ctrls=[],e=0;a>e;e++)g=new DUISelfCtrl(c),d.ctrls[g.id]=g;b()}}function DColor(a){this.R=a.readShort(),this.G=a.readShort(),this.B=a.readShort(),this.A=a.readShort(),this.IColor=function(){return new IColor(this.R,this.G,this.B,this.A)},this.TColor=function(){return"\\c["+this.R+","+this.G+","+this.B+"]"}}function DUIMText(rd){this.textType=rd.readShort(),this.text=rd.readString(),this.vid=rd.readInt(),this.textStyle=rd.readShort(),this.textStyleColor=new DColor(rd),this.isAutoUpdate=rd.readBool(),this.fontSize=rd.readInt(),this.fontColor=new DColor(rd),this.HAlign=rd.readShort(),this.VAlign=rd.readShort(),this.x=rd.readInt(),this.y=rd.readInt(),this.getDrawText=function(){var str="";return str=0==this.textType?RF.MakerValueText(this.text):1==this.textType?RV.GameData.getValues(this.vid):eval(this.text)}}function DUIDO(a){var b,c,d;for(this.eventType=a.readShort(),b=a.readInt(),this.eventEvents=[],c=0;b>c;c++)d=new DEvent,d.read(a),this.eventEvents.push(d);this.eventScript=a.readString()}function DUISelfCtrl(a){this.id=a.readInt(),this.name=a.readString(),this.script=a.readString(),this.initEvent=new DUIDO(a),this.initAfterEvent=new DUIDO(a),this.updateEvent=new DUIDO(a),this.ctrls=DUIMain.readCtrls(a);var b=this;this.getFiles=function(){var b,a=[];for(b=0;b<this.ctrls.length;b++)a=a.concat(this.ctrls[b].getFiles());return a},this.findData=function(a){for(var c=0;c<b.ctrls.length;c++)if(b.ctrls[c].key==a)return b.ctrls[c];return null}}function DUIMain(a){this.id=a.readInt(),this.level=a.readInt(),this.name=a.readString(),this.isEsc=a.readBool(),this.isMouse=a.readBool(),this.isParallel=a.readBool(),this.isAutoStart=a.readBool(),this.startIf=new DIf(a),this.scrpit=a.readString(),this.initEvent=new DUIDO(a),this.initAfterEvent=new DUIDO(a),this.updateEvent=new DUIDO(a),this.closeEvent=new DUIDO(a),this.ctrls=DUIMain.readCtrls(a);var b=this;this.getFiles=function(){var b,a=[];for(b=0;b<this.ctrls.length;b++)a=a.concat(this.ctrls[b].getFiles());return a},this.findData=function(a){for(var c=0;c<b.ctrls.length;c++)if(b.ctrls[c].key==a)return b.ctrls[c];return null}}function DUIBar(a){this.base=DUICtrlBase,this.base(),delete this.base,this.readBase(a),this.pic1=a.readString(),this.pic2=a.readString(),this.userValue=a.readShort(),this.min=a.readString(),this.max=a.readString(),this.minValue=a.readInt(),this.maxValue=a.readInt(),this.previewValue=a.readShort(),this.dir=a.readShort(),this.getFiles=function(){return["System/"+this.pic1.replace("\\","/"),"System/"+this.pic2.replace("\\","/")]}}function DUIText(rd){this.base=DUICtrlBase,this.base(),delete this.base,this.readBase(rd),this.textType=rd.readShort(),this.text=rd.readString(),this.vid=rd.readInt(),this.textStyle=rd.readShort(),this.textStyleColor=new DColor(rd),this.isAutoUpdate=rd.readBool(),this.fontSize=rd.readInt(),this.fontColor=new DColor(rd),this.isAutoLine=rd.readBool(),this.lineSize=rd.readInt(),this.lineHeight=rd.readShort()/100,this.getFiles=function(){return[]},this.getDrawText=function(){var str="",_sf={};return str=0==this.textType?RF.MakerValueText(this.text):1==this.textType?RV.GameData.getValues(this.vid):eval(this.text)}}function DUIView(a){this.base=DUICtrlBase,this.base(),delete this.base,this.readBase(a),this.width=a.readInt(),this.height=a.readInt(),this.type=a.readInt(),this.dir=a.readInt(),this.isMove=a.readBool(),this.isAutoMove=a.readBool(),this.ctrls=DUIMain.readCtrls(a),this.getFiles=function(){var b,a=[];for(b=0;b<this.ctrls.length;b++)a=a.concat(this.ctrls[b].getFiles());return a}}function DUICheck(a){var b,c;for(this.base=DUICtrlBase,this.base(),delete this.base,this.readBase(a),this.num=a.readInt(),this.defIndex=a.readInt(),this.pic1=a.readString(),this.pic2=a.readString(),this.pic3=a.readString(),this.dx=a.readInt(),this.dy=a.readInt(),this.checks=[],b=a.readInt(),c=0;b>c;c++)this.checks.push(new DUICheckMin(a));this.getFiles=function(){return["System/"+this.pic1.replace("\\","/"),"System/"+this.pic2.replace("\\","/"),"System/"+this.pic3.replace("\\","/")]}}function DUICheckMin(a){this.text=new DUIMText(a),this.enableIf=new DIf(a),this.changeEvent=new DUIDO(a),this.overEvent=new DUIDO(a)}function DUICtrlItem(a){this.base=DUICtrlBase,this.base(),delete this.base,this.readBase(a),this.id=a.readInt(),this.args=a.readString(),this.pwidth=a.readInt(),this.pheight=a.readInt(),this.getFiles=function(){var a=RV.NowUI.ctrls[this.id];return null!=a?a.getFiles():[]}}function DUIGroup(a){this.base=DUICtrlBase,this.base(),delete this.base,this.readBase(a),this.id=a.readInt(),this.obj=a.readString(),this.ifs=new DIf(a),this.dx=a.readInt(),this.dy=a.readInt(),this.r_num=a.readShort(),this.column=a.readShort(),this.pwidth=a.readInt(),this.pheight=a.readInt(),this.getFiles=function(){var a=RV.NowUI.ctrls[this.id];return null!=a?a.getFiles():[]}}function DUIButton(a){this.base=DUICtrlBase,this.base(),delete this.base,this.readBase(a),this.picType=a.readShort(),this.pic1=a.readString(),this.pic2=a.readString(),this.pic3=a.readString(),this.text=new DUIMText(a),this.enableIF=new DIf(a),this.hoverEvent=new DUIDO(a),this.clickEvent=new DUIDO(a),this.downEvent=new DUIDO(a),this.leaveEvent=new DUIDO(a),this.getFiles=function(){var a,b,c;return 0==this.picType?["System/"+this.pic1.replace("\\","/"),"System/"+this.pic2.replace("\\","/"),"System/"+this.pic3.replace("\\","/")]:(a=RV.GameData.getValues(parseInt(this.pic1)),b=RV.GameData.getValues(parseInt(this.pic2)),c=RV.GameData.getValues(parseInt(this.pic3)),["System/"+a,"System/"+b,"System/"+c])}}function DUIPic(a){this.base=DUICtrlBase,this.base(),delete this.base,this.readBase(a),this.userType=a.readShort(),this.pic=a.readString(),this.script=a.readString(),this.vid=a.readInt(),this.width=a.readInt(),this.height=a.readInt(),this.origin=a.readShort(),this.preview=a.readString(),this.getFiles=function(){if(0==this.userType)return["System/"+this.pic.replace("\\","/")];if(1==this.userType){var a=RV.GameData.getValues(parseInt(this.vid));return["System/"+a]}return 2==this.userType?[]:3==this.userType?[]:void 0}}function DUIRegion(a){this.base=DUICtrlBase,this.base(),delete this.base,this.readBase(a),this.width=a.readInt(),this.height=a.readInt(),this.longTime=a.readInt(),this.hoverEvent=new DUIDO(a),this.downEvent=new DUIDO(a),this.clickEvent=new DUIDO(a),this.longEvent=new DUIDO(a),this.leaveEvent=new DUIDO(a),this.getFiles=function(){return[]}}function DUIAutoPic(a){this.base=DUICtrlBase,this.base(),delete this.base,this.readBase(a),this.pic=a.readString(),this.width=a.readInt(),this.height=a.readInt(),this.fuc=a.readShort(),this.zsize=a.readInt(),this.x1=a.readInt(),this.x2=a.readInt(),this.y1=a.readInt(),this.y2=a.readInt(),this.getFiles=function(){return["System/"+this.pic.replace("\\","/")]}}function DUICtrlBase(){this.key="",this.level=0,this.msg="",this.viewportKey="",this.defShow=!1,this.showIf=null,this.reference="",this.HAlign=0,this.VAlign=0,this.pointUserValue=!1,this.x=0,this.y=0,this.zoomX=100,this.zoomY=100,this.angle=0,this.opacity=255;var b=this;this.readBase=function(a){b.key=a.readString(),b.level=a.readInt(),b.msg=a.readString(),b.viewportKey=a.readString(),b.defShow=a.readBool(),b.showIf=new DIf(a),b.reference=a.readString(),b.HAlign=a.readShort(),b.VAlign=a.readShort(),b.pointUserValue=a.readBool(),b.x=a.readInt(),b.y=a.readInt(),b.zoomX=a.readShort(),b.zoomY=a.readShort(),b.angle=a.readShort(),b.opacity=a.readShort()},this.HPointUI=function(a,b){var e,c=0,d=0;return this.pointUserValue?(e=RV.GameData.getValue(this.x,0),null!=e&&(d=e)):d=this.x,c=""==this.reference&&""==this.viewportKey?0==this.HAlign?d:1==this.HAlign?(RV.NowProject.gameWidth-a)/2+d:RV.NowProject.gameWidth-a+d:0==this.HAlign?b.x+d:1==this.HAlign?b.x+(b.width-a)/2+d:b.x+(b.width-a)+d},this.VPointUI=function(a,b){var e,c=0,d=0;return this.pointUserValue?(e=RV.GameData.getValue(this.y,0),null!=e&&(d=e)):d=this.y,c=""==this.reference&&""==this.viewportKey?0==this.VAlign?d:1==this.VAlign?(RV.NowProject.gameHeight-a)/2+d:RV.NowProject.gameHeight-a+d:0==this.VAlign?b.y+d:1==this.VAlign?b.y+(b.height-a)/2+d:b.y+(b.height-a)+d}}function UButton(a,b,c){var k,u,v,d=[],e=null,f=null,g=null,i=!1,j=!1;this.tag=null,k=!1,this.drawTitle=function(a,b,c){g.drawText(a,b,c)},u=this,void 0==c&&(c=null),d[0]=a,d[1]=b,v=new IRect(0,0,1,1),Object.defineProperty(this,"onload",{set:function(a){g=new ISprite(IBitmap.CBitmap(f.width,f.height),c),a(u)}}),f=new ISprite(d[0],c),i=!0,this.z=0,this.setBitmap=function(a,b,c){c&&(d[0]=null,d[1]=null),d[0]=a,d[1]=b,f.setBitmap(d[0]),k=!1},this.getText=function(){return g},this.dispose=function(){null!=g&&g.dispose(),null!=d[0]&&(d[0]=null),null!=d[1]&&(d[1]=null),null!=e&&(e=null),d=[],f.dispose()},this.disposeMin=function(){null!=g&&g.dispose(),f.disposeMin()},this.isSelected=function(){return f.isSelected()},this.setEnableBitmap=function(a){e=a},this.setEnable=function(a){null!=e&&i!=a&&(i=a,a?f.setBitmap(d[0]):f.setBitmap(e),k=!1)},this.getEnable=function(){return i},this.isClick=function(){return f.visible?i?2==f.isSelectTouch():!1:!1},this.isDown=function(){return f.isSelected()&&IInput.up},this.isOn=function(){return j},this.cancelSelect=function(){if(j){j=!1;var a=d[j?1:0];a!=f.getBitmap()&&f.setBitmap(a)}},this.getBack=function(){return f},this.getX=function(){return f.x},this.getY=function(){return f.y},this.getZ=function(){return f.z},this.setX=function(a){f.x=a,null!=g&&(g.x=a)},this.setY=function(a){f.y=a,null!=g&&(g.y=a)},this.setZ=function(a){f.z=a,null!=g&&(g.z=a+1)},this.setZoomX=function(a){f.zoomX=a,null!=g&&(g.zoomX=a)},this.setZoomY=function(a){f.zoomY=a,null!=g&&(g.zoomY=a)},this.setVisible=function(a){f.visible=a,null!=g&&(g.visible=a)},this.getWidth=function(){return f.width*f.zoomX},this.getHeight=function(){return f.height*f.zoomY},this.setOpactiy=function(a){f.opacity=a,null!=g&&(g.opacity=a)},Object.defineProperty(this,"x",{get:function(){return f.x},set:function(a){f.x=a,null!=g&&(g.x=a)}}),Object.defineProperty(this,"y",{get:function(){return f.y},set:function(a){f.y=a,null!=g&&(g.y=a)}}),Object.defineProperty(this,"z",{get:function(){return f.z},set:function(a){f.z=a,null!=g&&(g.z=a+1)}}),Object.defineProperty(this,"zoomX",{get:function(){return f.zoomX},set:function(a){f.zoomX=a,null!=g&&(g.zoomX=a)}}),Object.defineProperty(this,"zoomY",{get:function(){return f.zoomY},set:function(a){f.zoomY=a,null!=g&&(g.zoomY=a)}}),Object.defineProperty(this,"visible",{get:function(){return f.visible},set:function(a){f.visible=a,null!=g&&(g.visible=a)}}),Object.defineProperty(this,"opacity",{get:function(){return f.opacity},set:function(a){f.opacity=a,null!=g&&(g.opacity=a)}}),Object.defineProperty(this,"width",{get:function(){return f.width*f.zoomX},set:function(){}}),Object.defineProperty(this,"height",{get:function(){return f.height*f.zoomY},set:function(){}}),Object.defineProperty(this,"angle",{get:function(){return f.angle},set:function(a){f.angle=a,null!=g&&(g.angle=a)}}),this.GetRect=function(){return v.left=u.getX(),v.top=u.getY(),v.right=u.getX()+u.getWidth(),v.bottom=u.getY()+u.getHeight(),v},this.fade=function(a,b,c){f.fade(a,b,c),null!=g&&g.fade(a,b,c)},this.fadeTo=function(a,b){f.fadeTo(a,b),null!=g&&g.fadeTo(a,b)},this.slide=function(a,b,c,d,e){f.slide(a,b,c,d,e),null!=g&&g.slide(a,b,c,d,e)},this.slideTo=function(a,b,c){f.slideTo(a,b,c),null!=g&&g.slideTo(a,b,c)},this.scale=function(a,b,c,d,e){f.scale(a,b,c,d,e),null!=g&&g.scale(a,b,c,d,e)},this.scaleTo=function(a,b,c){f.scaleTo(a,b,c),null!=g&&g.scaleTo(a,b,c)},this.rotateTo=function(a,b){f.rotateTo(a,b),null!=g&&g.rotateTo(a,b)},this.setAction=function(){null!=g&&g.addAction.apply(g,arguments)},this.setActLoop=function(a){f.actionLoop=a,null!=g&&(g.actionLoop=a)},this.getActLoop=function(){return f.actionLoop},this.update=function(){var a,b;return i?f.visible?(a=f.isSelectTouch(),2==a?!0:(j=k||1==a,b=d[j?1:0],b!=f.getBitmap()&&f.setBitmap(b),!1)):!1:!1}}function UCheck(baseZ,data,view,_sf,obj){function setEnableMin(a,b){null!=a.enableBitmap&&a.enable!=b&&(a.enable=b,b?a.setBitmap(a.indexCode==ck.index?bmp2:bmp1):a.setBitmap(bmp3))}function updateSlide(){0>=slideFrames||(slideFrames-=1,0>=slideFrames?(ck.x=endX,ck.y=endY):(tmpX+=diffX,tmpY+=diffY,ck.x=tmpX,ck.y=tmpY))}var x,y,z,dx,dy,zoomX,zoomY,opacity,angle,visible,checks,files,bmp1,bmp2,bmp3,ck,rect,slideFrames,endX,endY,diffX,diffY,tmpX,tmpY,i,min,sp,td,dText,size,tx,ty;for(this.data=data,this.index=data.defIndex,x=0,y=0,z=0,dx=data.dx,dy=data.dy,zoomX=1,zoomY=1,opacity=1,angle=0,visible=!0,checks=[],files=data.getFiles(),bmp1=RF.LoadCache(files[0]),bmp2=RF.LoadCache(files[1]),bmp3=RF.LoadCache(files[2]),ck=this,rect=new IRect(0,0,1,1),slideFrames=0,endX=0,endY=0,diffX=0,diffY=0,tmpX=0,tmpY=0,data.showIf.setOutData(_sf,obj),i=0;i<data.checks.length;i++)min=data.checks[i],sp=new ISprite(i==data.defIndex?bmp2:bmp1,view),sp.indexCode=i,sp.enable=!0,"System/"!=files[2]&&(sp.enableBitmap=bmp3),td=min.text,dText="",dText=2==td.textType?td.fontColor.TColor()+"\\s["+td.fontSize+"]"+eval(td.text):td.fontColor.TColor()+"\\s["+td.fontSize+"]"+td.getDrawText(),size=DUI.DrawTextSize(dText,!1,0),tx=DUI.HPoint(td.x,td.HAlign,sp.width,size.width),ty=DUI.VPoint(td.y,td.VAlign,sp.height,size.height),sp.drawText(dText,tx,ty,td.textStyle,td.textStyleColor.IColor(),!1,0),sp.tag=dText,sp.z=baseZ+data.level,z=data.level,zoomY=sp.zoomX=data.zoomX/100,zoomX=sp.zoomY=data.zoomY/100,opacity=sp.opacity=data.opacity/255,angle=sp.angle=data.angle,min.enableIf.setOutData(_sf,obj),setEnableMin(sp,min.enableIf.result()),visible=sp.visible=data.showIf.result(),checks.push(sp);Object.defineProperty(this,"x",{get:function(){return x},set:function(a){x=a;for(var b=0;b<checks.length;b++)checks[b].x=x+this.dx*b}}),Object.defineProperty(this,"y",{get:function(){return y},set:function(a){y=a;for(var b=0;b<checks.length;b++)checks[b].y=y+dy*b}}),Object.defineProperty(this,"dx",{get:function(){return dx},set:function(a){dx=a;for(var b=0;b<checks.length;b++)checks[b].x=x+dx*b}}),Object.defineProperty(this,"dy",{get:function(){return dy},set:function(a){dy=a;for(var b=0;b<checks.length;b++)checks[b].y=y+dy*b}}),Object.defineProperty(this,"z",{get:function(){return z},set:function(a){z=a;for(var b=0;b<checks.length;b++)checks[b].z=z}}),Object.defineProperty(this,"zoomX",{get:function(){return zoomX},set:function(a){zoomX=a;for(var b=0;b<checks.length;b++)checks[b].zoomX=zoomX}}),Object.defineProperty(this,"zoomY",{get:function(){return zoomY},set:function(a){zoomY=a;for(var b=0;b<checks.length;b++)checks[b].zoomY=zoomY}}),Object.defineProperty(this,"visible",{get:function(){return visible
},set:function(a){visible=a;for(var b=0;b<checks.length;b++)checks[b].visible=visible}}),Object.defineProperty(this,"opacity",{get:function(){return opacity},set:function(a){opacity=a;for(var b=0;b<checks.length;b++)checks[b].opacity=opacity}}),Object.defineProperty(this,"width",{get:function(){var b,c,a=0;for(b=0;b<checks.length;b++)c=checks[b].x+checks[b].width*checks[b].zoomX-x,c>a&&(a=c);return a},set:function(){}}),Object.defineProperty(this,"height",{get:function(){var b,c,a=0;for(b=0;b<checks.length;b++)c=checks[b].y+checks[b].height*checks[b].zoomY-y,c>a&&(a=c);return a},set:function(){}}),Object.defineProperty(this,"angle",{get:function(){return angle},set:function(a){angle=a;for(var b=0;b<checks.length;b++)checks[b].angle=angle}}),this.GetRect=function(){return rect.left=ck.x,rect.top=ck.y,rect.right=ck.x+ck.width,rect.bottom=ck.y+ck.height,rect},this.fadeTo=function(a,b){for(var c=0;c<checks.length;c++)checks[c].fadeTo(a,b)},this.slideTo=function(a,b,c){this.slide(ck.x,ck.y,a,b,c)},this.scaleTo=function(a,b,c){for(var d=0;d<checks.length;d++)checks[d].scaleTo(a,b,c)},this.rotateTo=function(a,b){for(var c=0;c<checks.length;c++)checks[c].rotateTo(a,b)},this.slide=function(a,b,c,d,e){0>=e?(ck.x=c,ck.y=d):(slideFrames=e,endX=c,endY=d,diffX=(endX-a)/parseFloat(e),diffY=(endY-b)/parseFloat(e),tmpX=a,tmpY=b,ck.x=a,ck.y=b)},this.SelectIndex=function(cindex){var i,min,sp,td,dText,size,tx,ty;if(!(data.checks.length-1<cindex)&&checks[cindex].enable){for(ck.index=cindex,i=0;i<checks.length;i++)checks[i].setBitmap(cindex==i?bmp2:bmp1),min=data.checks[i],sp=checks[i],td=min.text,dText="",dText=2==td.textType?td.fontColor.TColor()+"\\s["+td.fontSize+"]"+eval(td.text):td.fontColor.TColor()+"\\s["+td.fontSize+"]"+td.getDrawText(),size=DUI.DrawTextSize(dText,!1,0),tx=DUI.HPoint(td.x,td.HAlign,sp.width,size.width),ty=DUI.VPoint(td.y,td.VAlign,sp.height,size.height),checks[i].clearBitmap(),sp.drawText(dText,tx,ty,td.textStyle,td.textStyleColor.IColor(),!1,0),sp.updateBitmap(),sp.tag=dText;0==data.checks[cindex].changeEvent.eventType?_sf.getInterpreterMain().isEnd&&_sf.getInterpreterMain().addEvents(data.checks[cindex].changeEvent.eventEvents):1==data.checks[cindex].changeEvent.eventType&&eval(data.checks[cindex].changeEvent.eventScript)}},this.DoAction=function(cindex){var i,min,sp,td,dText,size,tx,ty;if(!(data.checks.length-1<cindex)&&checks[cindex].enable)if(ck.index==cindex)0==data.checks[cindex].overEvent.eventType?_sf.getInterpreterMain().isEnd&&_sf.getInterpreterMain().addEvents(data.checks[cindex].overEvent.eventEvents):1==data.checks[cindex].overEvent.eventType&&eval(data.checks[cindex].overEvent.eventScript);else{for(ck.index=cindex,i=0;i<checks.length;i++)checks[i].setBitmap(cindex==i?bmp2:bmp1),min=data.checks[i],sp=checks[i],td=min.text,dText="",dText=2==td.textType?td.fontColor.TColor()+"\\s["+td.fontSize+"]"+eval(td.text):td.fontColor.TColor()+"\\s["+td.fontSize+"]"+td.getDrawText(),size=DUI.DrawTextSize(dText,!1,0),tx=DUI.HPoint(td.x,td.HAlign,sp.width,size.width),ty=DUI.VPoint(td.y,td.VAlign,sp.height,size.height),checks[i].clearBitmap(),sp.drawText(dText,tx,ty,td.textStyle,td.textStyleColor.IColor(),!1,0),sp.updateBitmap(),sp.tag=dText;0==data.checks[cindex].changeEvent.eventType?_sf.getInterpreterMain().isEnd&&_sf.getInterpreterMain().addEvents(data.checks[cindex].changeEvent.eventEvents):1==data.checks[cindex].changeEvent.eventType&&eval(data.checks[cindex].changeEvent.eventScript)}},this.update=function(){var i,min,dText,size,x,y;if(updateSlide(),ck.visible=data.showIf.result(),ck.visible)for(i=0;i<checks.length;i++)if(min=data.checks[i],setEnableMin(checks[i],min.enableIf.result()),checks[i].enable&&(min.text.isAutoUpdate&&(dText="",dText=2==min.text.textType?min.text.fontColor.TColor()+"\\s["+min.text.fontSize+"]"+eval(min.text.text):min.text.fontColor.TColor()+"\\s["+min.text.fontSize+"]"+min.text.getDrawText(),dText!=checks[i].tag&&(size=DUI.DrawTextSize(dText,!1,0),x=DUI.HPoint(min.text.x,min.text.HAlign,checks[i].width,size.width),y=DUI.VPoint(min.text.y,min.text.VAlign,checks[i].height,size.height),checks[i].clearBitmap(),checks[i].drawText(dText,x,y,ctrl.data.text.textStyle,ctrl.data.text.textStyleColor.IColor(),!1,0),checks[i].tag=dText)),checks[i].isSelected()&&IInput.up))return ck.DoAction(i),void 0},this.dispose=function(){for(var a=0;a<checks.length;a++)checks[a].disposeMin()},this.getSprite=function(a){return checks[a]}}function UAutoPic(a,b,c){function y(){0==b.fuc?(m[0]=new IBCof(l,0,0,b.zsize,b.zsize),m[1]=new IBCof(l,b.zsize,0,l.width-2*b.zsize,b.zsize),m[2]=new IBCof(l,l.width-b.zsize,0,b.zsize,b.zsize),m[3]=new IBCof(l,0,b.zsize,b.zsize,l.height-2*b.zsize),m[4]=new IBCof(l,l.width-b.zsize,b.zsize,b.zsize,l.height-2*b.zsize),m[5]=new IBCof(l,0,l.height-b.zsize,b.zsize,b.zsize),m[6]=new IBCof(l,l.width-b.zsize,l.height-b.zsize,b.zsize,b.zsize),m[7]=new IBCof(l,b.zsize,l.height-b.zsize,l.width-2*b.zsize,b.zsize),m[8]=new IBCof(l,b.zsize,b.zsize,l.width-2*b.zsize,l.height-2*b.zsize)):(m[0]=new IBCof(l,0,0,b.x1,b.y1),m[1]=new IBCof(l,b.x1,0,l.width-(b.x1+b.x2),b.y1),m[2]=new IBCof(l,l.width-b.x2,0,b.x2,b.y1),m[3]=new IBCof(l,0,b.y1,b.x1,l.height-(b.y1+b.y2)),m[4]=new IBCof(l,l.width-b.x2,b.y1,b.x2,l.height-(b.y1+b.y2)),m[5]=new IBCof(l,0,l.height-b.y2,b.x1,b.y2),m[6]=new IBCof(l,l.width-b.x2,l.height-b.y2,b.x2,b.y2),m[7]=new IBCof(l,b.x1,l.height-b.y2,l.width-(b.x1+b.x2),b.y2),m[8]=new IBCof(l,b.x1,b.y1,l.width-(b.x1+b.x2),l.height-(b.y1+b.y2)));for(var a=0;9>a;a++)w[a]=new ISprite(m[a],c);v.x=d,v.y=e,v.width=g,v.height=h,v.visible=i,v.z=f}function z(){0>=o||(o-=1,0>=o?(v.x=p,v.y=q):(t+=r,u+=s,v.x=t,v.y=u))}var x,d=0,e=0,f=0,g=b.width,h=b.height,i=!0,j=1,k=b.getFiles(),l=RF.LoadCache(k[0]),m=[],n=new IRect(0,0,1,1),o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=this,w=[];l.complete?y():null==l.onload?l.onload=function(){y()}:(x=l.onload,l.onload=function(){x(),y()}),this.GetRect=function(){return n.left=v.x,n.top=v.y,n.right=v.x+v.width,n.bottom=v.y+v.height,n},Object.defineProperty(this,"x",{get:function(){return d},set:function(a){d=a,w.length<=0||(w[0].x=d,w[1].x=d+m[0].width,w[2].x=d+(g-m[2].width),w[3].x=d,w[4].x=d+(g-m[2].width),w[5].x=d,w[6].x=d+(g-m[2].width),w[7].x=d+m[0].width,w[8].x=d+m[0].width)}}),Object.defineProperty(this,"y",{get:function(){return e},set:function(a){e=a,w.length<=0||(w[0].y=e,w[1].y=e,w[2].y=e,w[3].y=e+m[0].height,w[4].y=e+m[0].height,w[5].y=e+(h-m[5].height),w[6].y=e+(h-m[5].height),w[7].y=e+(h-m[5].height),w[8].y=e+m[0].height)}}),Object.defineProperty(this,"z",{get:function(){return f},set:function(a){if(f=a,!(w.length<=0))for(var b=0;b<w.length;b++)w[b].z=f}}),Object.defineProperty(this,"width",{get:function(){return g},set:function(a){var b,c;g=a,w.length<=0||(b=g-(m[0].width+m[2].width),0>b&&(b=1),c=b/m[1].width,w[1].zoomX=c,w[7].zoomX=c,w[8].zoomX=c,v.x=d)}}),Object.defineProperty(this,"height",{get:function(){return h},set:function(a){var b,c;h=a,w.length<=0||(b=h-(m[0].height+m[5].height),0>b&&(b=1),c=b/m[3].height,w[3].zoomY=c,w[4].zoomY=c,w[8].zoomY=c,v.y=e)}}),Object.defineProperty(this,"visible",{get:function(){return i},set:function(a){if(i=a,!(w.length<=0))for(var b=0;b<w.length;b++)w[b].visible=i}}),Object.defineProperty(this,"opacity",{get:function(){return j},set:function(a){if(j=a,!(w.length<=0))for(var b=0;b<w.length;b++)w[b].opacity=j}}),this.update=function(){z()},this.slideTo=function(a,b,c){this.slide(v.x,v.y,a,b,c)},this.slide=function(a,b,c,d,e){0>=e?(v.x=c,v.y=d):(o=e,p=c,q=d,r=(p-a)/parseFloat(e),s=(q-b)/parseFloat(e),t=a,u=b,v.x=a,v.y=b)},this.pauseAnim=function(){for(var a=0;a<w.length;a++)w[a].pauseAnim()},this.addAction=function(){for(var c=0;c<w.length;c++)w[c].addAction.apply(w[c],arguments)},this.dispose=function(){for(var a=0;a<w.length;a++)w[a].disposeMin()}}function LCtrlGroup(ui,data,view,z){function updatePointMin(){var c,a=x,b=y-dy;for(c=0;c<cg.ctrlItems.length;c++)0==c%cg.data.column&&(b+=dy,a=x),cg.ctrlItems[c].x=a,cg.ctrlItems[c].y=b,a+=dx}function updatePoint(){var e,f,g,a=LUI.getCtrlRect(cg.data,_sf.ctrlItems,0,0),b=cg.GetRect(),c=a.x+DUI.HPoint(cg.data.x,cg.data.HAlign,a.width,b.width),d=a.y+DUI.VPoint(cg.data.y,cg.data.VAlign,a.height,b.height);for(x=c,y=d,e=c,f=d-dy,g=0;g<cg.ctrlItems.length;g++)0==g%cg.data.column&&(f+=dy,e=c),cg.ctrlItems[g].x=e,cg.ctrlItems[g].y=f,e+=dx}function getSize(){var c,a=0,b=0-dy;for(cg.width=0,cg.height=0,c=0;c<cg.ctrlItems.length;c++)0==c%cg.data.column&&(b+=dy,a=0),a+cg.ctrlItems[c].width>cg.width&&(cg.width=a+cg.ctrlItems[c].width),b+cg.ctrlItems[c].height>cg.height&&(cg.height=b+cg.ctrlItems[c].height),a+=dx}var x,y,dx,dy,visible,doif,rect,forobj,index,i,c,_sf=ui,cg=this;if(this.data=data,this.ctrlItems=[],x=-13366758,y=-13366758,dx=data.dx,dy=data.dy,visible=!1,this.width=0,this.height=0,doif=cg.data.ifs,cg.data.showIf.setOutData(ui,null),rect=new IRect(0,0,1,1),this.cof=RV.NowUI.ctrls[this.data.id],null!=this.cof&&(forobj=eval(this.data.obj),index=0,null!=forobj))for(i in forobj)forobj.hasOwnProperty(i)&&(doif.setOutData(ui,forobj[i]),doif.result()&&(c=new LCtrl(this.cof,view,ui,forobj[i],cg.data),c.ctrlIndex=index,c.width=this.data.pwidth,c.height=this.data.pheight,this.ctrlItems.push(c),index+=1));getSize(),Object.defineProperty(this,"x",{get:function(){return x},set:function(a){x!=a&&(x=a,updatePointMin())}}),Object.defineProperty(this,"y",{get:function(){return y},set:function(a){y!=a&&(y=a,updatePointMin())}}),Object.defineProperty(this,"visible",{get:function(){return visible},set:function(a){if(a!=visible){visible=a;for(var b=0;b<cg.ctrlItems.length;b++)cg.ctrlItems[b].visible=visible}}}),this.update=function(){if(cg.visible=cg.data.showIf.result(),cg.visible)for(var a=0;a<cg.ctrlItems.length;a++)cg.ctrlItems[a].updateNowCtrl()},this.dispose=function(){for(var a=0;a<cg.ctrlItems.length;a++)cg.ctrlItems[a].disposeNowCtrl();cg.ctrlItems.length=0},this.changeIF=function(newif){var forobj,index,i,c;if(cg.dispose(),null!=this.cof&&(doif=newif,forobj=eval(this.data.obj),index=0,null!=forobj))for(i in forobj)forobj.hasOwnProperty(i)&&(doif.setOutData(ui,forobj[i]),doif.result()&&(c=new LCtrl(this.cof,view,ui,forobj[i],cg.data),c.ctrlIndex=index,c.width=cg.data.pwidth,c.height=cg.data.pheight,cg.ctrlItems.push(c),index+=1));getSize(),updatePoint()},this.GetRect=function(){return rect.left=cg.x,rect.top=cg.y,rect.right=cg.x+cg.width,rect.bottom=cg.y+cg.height,rect}}LUI.setText=function(a,b){var d,c=1.2;null!=a.data.lineHeight&&(c=a.data.lineHeight),d=ISprite.getDrawTextSize(b,a.data.isAutoLine,a.data.lineSize,c),a.disposeBitmap(),a.setBitmap(IBitmap.CBitmap(d.width,d.height)),a.width=d.width,a.height=d.height,a.drawText(b,0,0,a.data.textStyle,a.data.textStyleColor.IColor(),a.data.isAutoLine,a.data.lineSize),a.tag=b},LUI.getCtrlRect=function(a,b,c,d){var e,f,g,h;if(""==a.viewportKey){if(""==a.reference)return new IRect(0,0,RV.NowProject.gameWidth,RV.NowProject.gameHeight);for(e=0;e<b.length;e++)if(b[e].data.key==a.reference)return f=b[e].GetRect(),f.x-=c,f.y-=d,f}else if(g=LUI.findCtrlForKey(b,a.viewportKey),""==a.reference){if(null!=g&&g instanceof IViewport)return new IRect(0,0,g.GetRect().width,g.GetRect().height)}else if(null!=g&&g instanceof IViewport)for(h=g,e=0;e<h.ctrls.length;e++)if(h.ctrls[e].data.key==a.reference)return h.ctrls[e].GetRect();return new IRect(0,0,RV.NowProject.gameWidth,RV.NowProject.gameHeight)},LUI.findCtrlForKey=function(a,b){for(var c=0;c<a.length;c++)if(a[c].data.key==b)return a[c];return null},LUI.DisposeCtrl=function(a){var b,c;for(b=0;b<a.length;b++)c=a[b],c instanceof UButton?c.disposeMin():c instanceof UCheck?c.dispose():c instanceof IRect||(c instanceof IScrollbar?c.disposeMin():c instanceof IViewport?(LUI.DisposeCtrl(c.ctrls),c.dispose()):c.data instanceof DUIText?c.dispose():c instanceof LCtrl?c.disposeNowCtrl():c.data instanceof DUIPic?c.canDispose?c.dispose():c.disposeMin():c.data instanceof DUIAutoPic?c.dispose():c instanceof LCtrlGroup&&c.dispose());a.length=0},LUI.RePoint=function(a,b,c,d){var e=LUI.getCtrlRect(a.data,b,c,d),f=a.GetRect();a.x=a.data.HPointUI(f.width,e),a.y=a.data.VPointUI(f.height,e)},LUI.IMSelectCtlr=function(a,b){var d,c={};return null!=a.ctrl&&(d=a.ctrl.ctrlKeys[b],null!=d)?(c.ctrl=d,c.list=a.ctrl.ctrlItems,c.x=a.ctrl.x,c.y=a.ctrl.y,c):null!=a.ui&&(d=a.ui.ctrlKeys[b],null!=d)?(c.ctrl=d,c.list=a.ui.ctrlItems,c.x=0,c.y=0,c):(c.ctrl=null,c.list=null,c.x=0,c.y=0,c)},IM.UIMove=function(a,b){this.base=IEventBase,this.base(),delete this.base;var c=0;this.init=function(){var g,h,i,j,k,l,m,d=a.args[0],e=LUI.IMSelectCtlr(b,d),f=e.ctrl;return null!=f&&(g=parseInt(a.args[1]),"1"==a.args[2]&&(c=g)),h=0,i=0,"0"==a.args[3]?(h=parseInt(a.args[4]),i=parseInt(a.args[5])):(h=RV.GameData.getValueNum(parseInt(a.args[4]),0),i=RV.GameData.getValueNum(parseInt(a.args[5]),0)),null==f?!1:(j=LUI.getCtrlRect(f.data,e.list,e.x,e.y),k=f.GetRect(),l=j.x+DUI.HPoint(h,f.data.HAlign,j.width,k.width),m=j.y+DUI.VPoint(i,f.data.VAlign,j.height,k.height),f.slideTo(l,m,g),null!=f.scaleTo&&f.scaleTo(parseInt(a.args[6])/100,parseInt(a.args[7])/100,g),null!=f.fadeTo&&f.fadeTo(parseInt(a.args[8])/255,g),null!=f.rotateTo&&f.rotateTo(parseInt(a.args[9]),g),!1)},this.update=function(){c-=1},this.isFinish=function(){return 0>=c}},IM.UIDisposeCtrl=function(a,b){this.base=IEventBase,this.base(),delete this.base,this.init=function(){var c=a.args[0],d=null,e=[];return null!=b.ctrl&&(d=b.ctrl.ctrlKeys[c],null!=d)?(e.push(d),LUI.DisposeCtrl(e),delete b.ctrl.ctrlKeys[c],b.ctrl.ctrlItems.remove(d),void 0):null!=b.ui&&(d=b.ui.ctrlKeys[c],null!=d)?(e.push(d),LUI.DisposeCtrl(e),delete b.ui.ctrlKeys[c],b.ui.ctrlItems.remove(d),void 0):!1}},IM.UIDisposeAll=function(a,b){this.base=IEventBase,this.base(),delete this.base,this.init=function(){return null!=b.ui&&(LUI.DisposeCtrl(b.ui.ctrlItems),b.ui.ctrlKeys.length=0),!1}},IM.UICheckIndex=function(a,b){this.base=IEventBase,this.base(),delete this.base,this.init=function(){var c=a.args[0],d=parseInt(a.args[1]),e=LUI.IMSelectCtlr(b,c).ctrl;return e instanceof UCheck&&e.index!=d&&e.DoAction(d),!1}},IM.UIPic=function(event,main){this.base=IEventBase,this.base(),delete this.base,this.init=function(){var key,type,ctrl,bitmap,p,_sf=null,obj=null;return null!=main.ctrl&&(_sf=main.ctrl,obj=main.ctrl.obj),null==main.ctrl&&null!=main.ui&&(_sf=main.ui),key=event.args[0],type=parseInt(event.args[1]),ctrl=LUI.IMSelectCtlr(main,key).ctrl,ctrl.data instanceof DUIPic&&(ctrl.canDispose=!1,bitmap=null,0==type?(p="System/"+event.args[2].replace("\\","/"),bitmap=RF.LoadCache(p)):1==type?(p="System/"+RV.GameData.getValues(parseInt(event.args[2])),bitmap=RF.LoadCache(p)):2==type?bitmap=RF.LoadCache(eval(event.args[2])):3==type&&(bitmap=IBitmap.CBitmap(parseInt(event.args[2]),parseInt(event.args[3])),ctrl.canDispose=!0),bitmap.complete?(ctrl.setBitmap(bitmap),ctrl.width=bitmap.width,ctrl.height=bitmap.height):bitmap.onload=function(){ctrl.setBitmap(bitmap),ctrl.width=bitmap.width,ctrl.height=bitmap.height}),!1}},IM.UIAutoPicSize=function(a,b){this.base=IEventBase,this.base(),delete this.base,this.init=function(){var c=a.args[0],d=LUI.IMSelectCtlr(b,c).ctrl;return d instanceof UAutoPic&&(d.width=parseInt(a.args[1]),d.height=parseInt(a.args[2])),!1}},IM.UITextChange=function(event,main){this.base=IEventBase,this.base(),delete this.base,this.init=function(){var key,type,ctrl,dText,_sf=null,obj=null;return null!=main.ctrl&&(_sf=main.ctrl,obj=main.ctrl.obj),null==main.ctrl&&null!=main.ui&&(_sf=main.ui),key=event.args[0],type=parseInt(event.args[1]),ctrl=LUI.IMSelectCtlr(main,key).ctrl,ctrl.data instanceof DUIText&&(dText="",dText=2==type?ctrl.data.fontColor.TColor()+"\\s["+ctrl.data.fontSize+"]"+eval(event.args[2]):ctrl.data.fontColor.TColor()+"\\s["+ctrl.data.fontSize+"]"+this.getDrawText(type,event.args[2]),dText!=ctrl.tag&&LUI.setText(ctrl,dText)),!1},this.getDrawText=function(type,text){var str="";return str=0==type?RF.MakerValueText(text):1==type?RV.GameData.getValues(parseInt(text)):eval(text)}},IM.UIChangeIF=function(a,b){function c(){var d,e,f,b=a,c=new DIf;for(c.type=parseInt(b.args[1]),c.haveElse="1"==b.args[2],d=3;d<b.args.length;d++)e=b.args[d].split("Φ"),f=new DIfItem,f.type=parseInt(e[0]),f.num1Index=parseInt(e[1]),f.fuc=parseInt(e[2]),f.type2=parseInt(e[3]),f.num2=e[4],f.num2Index=parseInt(e[5]),c.items.push(f);return c}this.base=IEventBase,this.base(),delete this.base,this.init=function(){var f,d=a.args[0],e=LUI.IMSelectCtlr(b,d).ctrl;return e instanceof LCtrlGroup&&(f=c(),e.changeIF(f)),!1}},IM.UICloseUI=function(a,b){this.base=IEventBase,this.base(),delete this.base,this.init=function(){return null!=b.ui&&b.ui.closeUI(),!1}},IM.UIAngel=function(a,b){this.base=IEventBase,this.base(),delete this.base,this.init=function(){var e,f,g,c=null,d=null;return null!=b.ctrl&&(c=b.ctrl,d=b.ctrl.obj),null==b.ctrl&&null!=b.ui&&(c=b.ui),e=a.args[0],f=parseInt(a.args[1]),g=LUI.IMSelectCtlr(b,e).ctrl,null!=g&&(g.angle=0==f?parseInt(a.args[2]):RV.GameData.getValueNum(parseInt(a.args[2]),0)),!1}},DUI.CacheUIRes=function(a,b){var f,g,h,c=0,d={};if(0==a.length)return b({}),void 0;for(f=0;f<a.length;f++)d[a[f]]=DUI.LoadCache(a[f]);for(g in d)h=d[g],h.complete?(c+=1,c>=Object.keys(d).length&&b(d)):null==h.onload||null==h.onerror?(h.onload=function(){c+=1,c>=Object.keys(d).length&&b(d)},h.onerror=function(){c+=1,c>=Object.keys(d).length&&b(d)}):(c+=1,c>Object.keys(d).length&&b(d))},DUI.LoadCache=function(a){return null==RV.Cache[a]?(RV.Cache[a]=RF.LoadBitmap(a),RV.Cache[a].loadTexture(),RV.Cache[a]):RV.Cache[a]},DUI.LoadCtrls=function(z,ctrl,view,_sf,obj){var endCtrl=null;return ctrl instanceof DUIButton?endCtrl=DUI.LoadButton(z,ctrl,view,_sf,obj):ctrl instanceof DUICheck?(endCtrl=new UCheck(z,ctrl,view,_sf,obj),endCtrl.z=z+ctrl.level,endCtrl.x=0,endCtrl.y=0):ctrl instanceof DUIPic?endCtrl=DUI.LoadImage(z,ctrl,view,_sf,obj):ctrl instanceof DUIRegion?endCtrl=DUI.LoadRegion(z,ctrl,view,_sf,obj):ctrl instanceof DUICtrlItem?endCtrl=DUI.LoadSelfCtrl(z,ctrl,view,_sf,obj):ctrl instanceof DUIBar?endCtrl=DUI.LoadBar(z,ctrl,view,_sf,obj):ctrl instanceof DUIView?endCtrl=DUI.LoadView(z,ctrl,view,_sf,obj):ctrl instanceof DUIText?endCtrl=DUI.LoadText(z,ctrl,view,_sf,obj):ctrl instanceof DUIAutoPic?endCtrl=DUI.LoadAutoPic(z,ctrl,view,_sf,obj):ctrl instanceof DUIGroup&&(endCtrl=new LCtrlGroup(_sf,ctrl,view,z)),eval("_sf."+ctrl.key+" = endCtrl;"),endCtrl},DUI.LoadSelfCtrl=function(z,data,view,_sf,obj){var ctrl,main=RV.NowUI.ctrls[data.id];return null!=main?(ctrl=new LCtrl(main,view,_sf,eval(data.args),data),ctrl.width=data.pwidth,ctrl.height=data.pheight,data.showIf.setOutData(_sf,obj),ctrl):null},DUI.LoadAutoPic=function(a,b,c,d,e){var f=new UAutoPic(a,b,c);return f.width=b.width,f.height=b.height,f.z=a+b.level,f.data=b,b.showIf.setOutData(d,e),f.visible=b.showIf.result(),f},DUI.LoadText=function(z,data,view,_sf,obj){var size,sp,td=data,dText="";return dText=2==td.textType?td.fontColor.TColor()+"\\s["+td.fontSize+"]"+eval(td.text):td.fontColor.TColor()+"\\s["+td.fontSize+"]"+td.getDrawText(),size=ISprite.getDrawTextSize(dText,data.isAutoLine,data.lineSize,data.lineHeight),sp=new ISprite(IBitmap.CBitmap(size.width,size.height),view),sp.data=data,sp.lineSpacing=data.lineHeight,sp.drawText(dText,0,0,td.textStyle,td.textStyleColor.IColor(),data.isAutoLine,data.lineSize),sp.z=z+data.level,sp.zoomX=data.zoomX/100,sp.zoomY=data.zoomY/100,sp.opacity=data.opacity/255,sp.angle=data.angle,sp.tag=dText,data.showIf.setOutData(_sf,obj),sp.visible=data.showIf.result(),sp},DUI.LoadView=function(a,b,c,d,e){var g,h,f=new IViewport(b.x,b.y,b.width,b.height,c);for(f.data=b,f.z=a+b.level,b.showIf.setOutData(d,e),f.visible=b.showIf.result(),f.type=0==b.type?IViewport.Type.Rectangle:IViewport.Type.Round,f.isAutoMove=b.isAutoMove,b.isMove?0==b.dir?f.dir=IViewport.Dir.None:1==b.dir?f.dir=IViewport.Dir.Vertical:2==b.dir?f.dir=IViewport.Dir.Horizontal:3==b.dir&&(f.dir=IViewport.Dir.All):f.dir=IViewport.Dir.None,f.ctrls=[],g=0;g<b.ctrls.length;g++)h=DUI.LoadCtrls(0,b.ctrls[g],f,d,e),f.ctrls.push(h),d.ctrlKeys[b.ctrls[g].key]=h;return f},DUI.LoadBar=function(a,b,c,d,e){var f=b.getFiles(),g=new IScrollbar(RF.LoadCache(f[0]),RF.LoadCache(f[1]),0,100,c);return g.data=b,g.dir=b.dir,g.z=a+b.level,g.GetRect=function(){return new IRect(g.x,g.y,g.x+g.width*g.zoomX,g.y+g.height*g.zoomY)},b.showIf.setOutData(d,e),g.visible=b.showIf.result(),g},DUI.LoadRegion=function(a,b){var f=new IRect(b.x,b.y,b.x+b.width,b.y+b.height);return f.data=b,f.GetRect=function(){return f},f.long=0,f.tempRect=new IRect(0,0,1,1),f.slideTo=function(a,b){f.x=a,f.y=b},f},DUI.LoadImage=function(z,data,view,_sf,obj){var files=data.getFiles(),sp=null;return 2==data.userType?(sp=new ISprite(RF.LoadCache(eval(data.script)),view),sp.canDispose=!1):3==data.userType?(sp=new ISprite(IBitmap.CBitmap(data.width,data.height),view),sp.canDispose=!0):(sp=new ISprite(RF.LoadCache(files[0]),view),sp.canDispose=!1),sp.data=data,sp.z=z+data.level,sp.zoomX=data.zoomX/100,sp.zoomY=data.zoomY/100,sp.opacity=data.opacity/255,sp.angle=data.angle,data.showIf.setOutData(_sf,obj),sp.yx=sp.yy=0==data.origin?0:.5,sp.visible=data.showIf.result(),sp},DUI.LoadButton=function(z,data,view,_sf,obj){var files=data.getFiles(),button=new UButton(RF.LoadCache(files[0]),RF.LoadCache(files[1]),view);return"System/"!=files[2]&&button.setEnableBitmap(RF.LoadCache(files[2])),button.data=data,button.onload=function(){var size,x,y,td=data.text,dText="";dText=2==td.textType?td.fontColor.TColor()+"\\s["+td.fontSize+"]"+eval(td.text):td.fontColor.TColor()+"\\s["+td.fontSize+"]"+td.getDrawText(),size=ISprite.getDrawTextSize(dText,!1,0,1),x=DUI.HPoint(td.x,td.HAlign,button.getBack().width,size.width),y=DUI.VPoint(td.y,td.VAlign,button.getBack().height,size.height),button.getText().drawText(dText,x,y,td.textStyle,td.textStyleColor.IColor(),!1,0),button.getText().tag=dText,button.z=z+data.level,button.zoomX=data.zoomX/100,button.zoomY=data.zoomY/100,button.opacity=data.opacity/255,button.angle=data.angle,data.showIf.setOutData(_sf,obj),data.enableIF.setOutData(_sf,obj),button.visible=data.showIf.result(),button.setEnable(data.enableIF.result())},button},DUI.HPoint=function(a,b,c,d){var e=0,f=0;return f=a,e=0==b?f:1==b?(c-d)/2+f:c-d+f},DUI.VPoint=function(a,b,c,d){var e=0,f=0;return f=a,e=0==b?f:1==b?(c-d)/2+f:c-d+f},DUIMain.readCtrls=function(a){var d,e,f,g,h,i,j,k,l,m,n,o,b=[],c=a.readInt();for(d=0;c>d;d++)e=a.readShort(),1==e?(f=new DUIButton(a),b.push(f)):2==e?(g=new DUIBar(a),b.push(g)):3==e?(h=new DUICheck(a),b.push(h)):4==e?(i=new DUIView(a),b.push(i)):5==e?(j=new DUIPic(a),b.push(j)):6==e?(k=new DUIAutoPic(a),b.push(k)):7==e?(l=new DUIRegion(a),b.push(l)):8==e?(m=new DUIText(a),b.push(m)):9==e?(n=new DUICtrlItem(a),b.push(n)):10==e&&(o=new DUIGroup(a),b.push(o));return b},DUI.DrawTextSize=function(a,b,c){for(var k,l,m,n,d=0,e=0,f=RF.TextAnalysis(a),g=0,h=0,i=16,j=IFont.getHeight("",i);;){if(f.length<=0)break;k=f.substring(0,1),f=f.substring(1),l=k.charCodeAt(0),6e4==l?(g=0,j=1.2*IFont.getHeight("",i),h+=j,e+=j):60001==l?(m=RF.TextToTemp(f,"[","]","\\[([0-9]+[，,][0-9]+[，,][0-9]+)]"),f=m[1]):60002==l?(m=RF.TextToTemp(f,"[","]","\\[([0-9]+)]"),i=parseInt(m[0]),f=m[1]):60003==l?m=RF.TextToTemp(f,"[","]","\\[([\\w/.]+)]"):60004==l?(n=RF.TextToTemp(f,"[","]","\\[([a-zA-Z0-9-_]+)]"),f=RV.GameData.getValues(parseInt(n[0]))+n[1]):(g+=IFont.getWidth(k,i),g>d&&(d=g),e<h+IFont.getHeight(k,i)&&(e=h+IFont.getHeight(k,i)),b&&g>=c&&(f=RF.CharToAScII(6e4)+f))}return 1>d&&(d=1),1>e&&(e=1),{width:d,height:e}};